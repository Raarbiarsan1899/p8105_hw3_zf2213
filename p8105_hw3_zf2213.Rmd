---
title: "P8105 Homework 3"
author: 'Zanis Fang, UID: ZF2213'
date: "10/4/2018"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

# ggplot2 tibble dplyr tidyr ... etc.
library(tidyverse)

#install p8105.datasets if not already installed
if (!"p8105.datasets" %in% installed.packages()) {
	devtools::install_github("p8105/p8105.datasets")
}

```

## Problem 1

### Data loading

```{r}
brfss <- p8105.datasets::brfss_smart2010 %>%
         # overall health topic
         filter(Topic == "Overall Health") %>% 
         # select necessary columns
         select(Year, Locationdesc, Response, Data_value) %>% 
         # seperate location into state and area
         separate(Locationdesc, c("state", "area"), sep = " - ") %>% 
         # recode response into factor variable
         mutate(Response = forcats::fct_relevel(Response,
                                                c("Excellent",
                                                  "Very good",
                                                  "Good",
                                                  "Fair",
                                                  "Poor"))) %>%
         # clean column names
         janitor::clean_names() %>% 
         # arrange dataset according to response from excellent to poor
         arrange(response)
 
```

*Q1. In 2002, which states were observed at 7 locations?*

```{r}
brfss %>% distinct(state, area) %>% 
          group_by(state) %>% 
          summarize(locations = n()) %>%
          filter(locations == 7)
```

Connecticut, Montana, New Hampshire, New Mexico, Oregon, Tennessee, Utah are observed at 7 locations.


*Q2. Make a “spaghetti plot” that shows the number of observations in each state from 2002 to 2010.*

```{r}
brfss %>% group_by(state, year) %>% 
          summarize(n_obs = n()) %>% 
          ggplot(aes(x = year, y = n_obs, color = state)) +
          geom_line() +
          theme(legend.position = "none")
```


*Q3. Make a table showing, for the years 2002, 2006, and 2010, the mean and standard deviation of the proportion of “Excellent” responses across locations in NY State.*


*Q4. For each year and state, compute the average proportion in each response category (taking the average across locations in a state). Make a five-panel plot that shows, for each response category separately, the distribution of these state-level averages over time.*



## Problem 2

### Data loading

```{r}
# load data
instacart <- p8105.datasets::instacart
             

```

## Problem 3

### Data loading

```{r}
ny_noaa <- p8105.datasets::ny_noaa
```


